# 询问

## 题目描述

给出一个初始为空的字符串 $S$，你需要完成接下来的若干组操作：

1. 在 $S$ 末尾加入一个小写字母。
2. 删除 $S$ 末尾的最后一个字母。

在每次操作结束后，你需要输出一个整数，表示此时 $S$ 中的回文子串个数。

## 输入格式

第一行，一个正整数 $n$ 表示操作的次数。

第二行，一个字符串 $Q$ 。

1. 若 $Q$ 的第 $i$ 位字符 $Q_i$ 为小写字母则表示在 $S$ 末尾加入一个小写字母 $Q_i$；
2. 若 $Q_i$ 为符号 $-$ 则表示删去 $S$ 末尾最后一个字母。

## 输出个数

一行，$n$ 个整数，第 $i$ 个整数表示经过前 $i$ 次操作后，$S$ 中的回文子串个数。

## 数据范围

保证每次操作后 $|S|>0$

| 测试数据 | n | 特殊性质 |
| :----- | :----: | :----: |
| 1~2 |$100$| 无|
| 3~6 | $10^3$ | $Q$由小写字母构成 |
| 7~19 | $10^4$ | 无 |
|20|$10^6$|无|

# Voronoi图

## 题目描述

![](image.png)
> 图 根据欧几里得度量，用 20 个点绘制的沃罗诺图。

在直角坐标系中，我们将大小为 n 的非空点集的Voronoi图定义为以 "集合中哪个点离这个位置最近 "为标准划分平面的图。例如，在上图中，平面上的每个位置都由与该位置最近的黑点着色。有一种算法可以计算 Voronoi 图，但这种算法非常复杂和困难。

在一次重要的比赛中，Minkyu 没能解决有关沃罗诺伊图的问题，这让他大受打击，从此开始了每天与酒精为伴的生活！在一个阳光明媚的下午，Minkyu 像往常一样喝着啤酒，发现了一种巧妙的求解 Voronoi 图的算法！在撰写相关论文之前，Minkyu 希望设置一个需要这种算法的问题，以防止在 2023 CSP-S 竞赛中出现满分选手。

为什么 Minkyu 的沃罗诺伊图算法如此出色？传统的沃罗诺伊图算法只适用于直角坐标，而 Minkyu 的算法适用于更广义的结构--"图"。考虑一个有 N 个顶点和 M 条带正权重的边的连通图。当给定一个大小为 K 的非空顶点子集时，这个点集的 "Voronoi 图 "就会按照 "一组中哪个顶点离这个位置最近？"的标准来划分边上的所有位置。如果有多个点的距离相等，则认为顶点编号最小的那个点距离最近。

给你一个加权连接图和一个大小为 K 的非空顶点子集。对于每个顶点，你应该计算出与给定顶点 "最近 "的边的总长度。解决这个问题，并以比 Minkyu 更快的速度写出论文，以分散他的殷切希望！